# AuraWell 更新日志

本文档记录了 AuraWell 项目的所有重要变更。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/) 规范。

## [v0.6.0] - 2025-06-16

### 新增功能
- **🏠 多成员家庭健康管理系统**: 完整的家庭多用户架构实现
- **🔐 三级权限体系**: Owner(主账号) → Manager(管理者) → Viewer(查看者)
- **👥 成员邀请流程**: 邮件邀请、接受/拒绝、角色分配完整流程
- **🔄 活跃成员切换**: 支持家庭内成员身份切换和数据隔离
- **📊 智能家庭仪表板**: 多成员健康数据聚合展示和分析
- **💬 WebSocket实时通信**: 支持实时聊天和数据推送
- **🤖 AI家庭健康顾问**: 基于家庭上下文的个性化健康建议
- **🔒 数据隐私保护**: 完整的数据脱敏和访问控制机制
- **📝 家庭活动审计**: 完整的操作日志和审计追踪
- **⚡ 性能优化**: 数据库连接池、缓存策略、异步处理优化

### 技术架构
- **项目结构重构**: 迁移到src/aurawell模块化架构
- **新增核心服务**: FamilyService、DashboardService、ReportService
- **权限控制系统**: 基于装饰器的RBAC权限管理
- **数据访问层**: Repository模式和事务管理
- **WebSocket集成**: 实时通信和消息路由系统
- **健康常量管理**: 集中化的健康指标和常量配置

### API接口扩展
- **家庭管理API**: 15+个家庭CRUD和成员管理接口
- **仪表板API**: 多维度健康数据聚合接口
- **权限管理API**: 动态权限查询和验证接口
- **WebSocket接口**: 实时聊天和数据推送支持

### 改进
- **代码质量**: 完整的类型注解和文档字符串
- **错误处理**: 统一的异常处理和错误响应
- **性能优化**: 数据库查询优化和缓存策略
- **安全增强**: 输入验证、数据脱敏、审计日志

### 修复
- **导入路径**: 修复所有模块导入路径问题
- **循环依赖**: 解决permissions.py循环导入问题
- **数据模型**: 修复响应模型泛型和序列化问题
- **WebSocket**: 修复连接状态管理和消息路由问题

### 清理
- **测试文件**: 清理有导入错误的测试文件
- **缓存文件**: 清理__pycache__和过时的缓存
- **文档整理**: 移除过时的重构笔记和临时文档

## [v0.5.0] - 2025-06-09

### 新增功能
- **API响应格式标准化**: 实现统一的响应格式（BaseResponse, SuccessResponse, ErrorResponse）
- **业务错误码系统**: 70+个分类清晰的错误码，覆盖认证、验证、业务逻辑等各个方面
- **集中式异常处理**: 统一的异常处理中间件，标准化错误响应
- **请求追踪**: 添加请求ID和时间戳，便于调试和问题排查
- **强化数据验证**: 
  - 密码强度验证（大写字母+数字要求）
  - 用户名格式验证（字母数字下划线）
  - 跨字段验证（BMI合理性检查）
  - 健康目标类型特定验证
- **完整分页系统**: 
  - PaginationParams和PaginationMeta模型
  - 多字段排序功能（升序/降序）
  - 综合过滤系统（搜索、状态、日期范围等）
- **批量操作**: 健康目标批量管理功能，支持最多50个项目
- **Redis缓存系统**: 
  - 智能缓存不同类型数据
  - 自动降级机制
  - 缓存失效和一致性管理
- **异步任务处理**: 
  - 后台任务管理系统
  - 任务状态追踪
  - 并发控制和资源管理
- **性能监控**: 
  - 请求时间监控
  - 缓存命中率统计
  - 慢请求检测和告警

### 改进
- **API接口增强**: 新增分页健康目标端点，支持完整的查询、排序、过滤功能
- **性能优化**: 
  - 连接池管理
  - 查询优化工具
  - 缓存装饰器
- **开发体验**: 
  - 更新测试套件以验证新响应格式
  - 完善的错误处理和用户反馈
  - 详细的API文档和参数描述

### 技术架构
- **泛型响应模型**: 类型安全的API设计
- **多层验证体系**: 字段验证、业务逻辑验证、跨字段验证
- **灵活查询系统**: 分页、排序、过滤、搜索一体化
- **缓存策略**: 针对不同数据类型的智能缓存
- **性能监控**: 实时性能指标收集和分析

### 修复
- 修复API响应格式不一致的问题
- 解决数据验证不够严格的问题
- 修复缺少错误码和详细错误信息的问题
- 解决性能监控缺失的问题

## [v0.4.0] - 2025-06-07

### 新增功能
- **SQLAlchemy数据库集成**: 完整的异步ORM数据库层
- **Repository模式**: 数据访问层抽象
- **数据库迁移**: 自动化数据库初始化和迁移工具
- **多数据库支持**: SQLite和PostgreSQL支持
- **数据持久化**: 用户档案、健康数据、成就系统完整持久化

### 技术架构
- 7个核心数据表设计和ORM模型
- 异步数据库操作和连接池管理
- Repository模式和服务层抽象
- 完整的CRUD操作和复杂查询支持

## [v0.3.0] - 2025-06-06

### 新增功能
- **Vue 3前端框架**: 集成现代化前端开发环境
- **前后端分离**: 实现完整的前后端分离架构

### 修复
- 修复ConversationAgent演示模式bug
- 解决urllib3版本兼容性问题
- 修复数据模型验证逻辑错误

### 改进
- 重构测试框架，提升断言逻辑
- 添加数据验证工具模块
- 完善错误处理机制

## [v0.2.0] - 2025-06-05

### 新增功能
- **智能工具注册中心**: HealthToolsRegistry
- **5个核心健康操作工具**: 完整的健康数据管理
- **对话智能体**: ConversationAgent核心
- **命令行界面**: CLI交互支持
- **OpenAI Function Calling**: 兼容标准工具调用

### 技术架构
- 完全异步的工具调用系统
- 动态工具注册和发现机制
- 自然语言到工具调用的映射

## [v0.1.0] - 2025-06-04

### 新增功能
- **核心数据模型**: 基于Pydantic的数据模型
- **健康数据解析器**: 多平台健康数据解析
- **基础配置管理**: 项目配置和环境管理
- **项目结构**: 完整的项目架构搭建

---

## 版本说明

### 版本命名规范
- **主版本** (v1.0.0): 重大功能更新，可能包含破坏性变更
- **次版本** (v0.5.0): 新功能添加，向后兼容
- **修订版本** (v0.5.1): Bug修复，向后兼容

### 变更类型
- **新增功能** (Added): 新功能
- **修复** (Fixed): Bug修复
- **改进** (Changed): 现有功能的变更
- **弃用** (Deprecated): 即将移除的功能
- **移除** (Removed): 已移除的功能
- **安全** (Security): 安全相关的修复

### 链接
- [项目仓库](https://github.com/PrescottClub/AuraWell_Agent)
- [问题反馈](https://github.com/PrescottClub/AuraWell_Agent/issues)
- [版本管理指南](docs/VERSION_MANAGEMENT.md)
